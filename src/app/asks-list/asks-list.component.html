<div class="row container  mb-5">
  <h2>Dernières demandes de permutations</h2>
  <p *ngIf='asks === undefined'
    class="row col-12 btn-info disabled">
    Il n'y a pas encore de demandes de permutation
  </p>
  <table class="col-12">
    <thead>
      <tr class="border-bottom">
        <th class="pb-2 pl-4"> Repos </th>
        <th class="pb-2 pl-4"> Proposé </th>
        <th class="pb-2 pl-4"> Souhaité </th>
        <th class="pb-2 pl-4"> Equipe </th>
        <th class="pb-2 pl-4"> Début </th>
        <th class="pb-2 pl-4"> Fin </th>
        <th class="pb-2 pl-4"> Action </th>
      </tr>
    </thead>
    <tbody *ngFor="let ask of asks; let i = index">
      <tr 
        class="border-bottom"
        [ngStyle]="{ 'background-color' : getColor(ask) }">
        <td class="pl-4"> {{ ask.rest }} </td>
        <td class="pl-4"> {{ ask.type }} </td>
        <td class="pl-4"> 
          {{ ask.typeVs.nuit == true ? "Nuit" : '' }} 
          {{ ask.typeVs.jour == true ? "Jour" : '' }}   
          {{ ask.typeVs.mixte == true ? "Mixte" : '' }}   
        </td>
        <td class="pl-4"> {{ ask.teamNb }} </td>
        <td class="pl-4"> {{ ask.start }} </td>
        <td class="pl-4"> {{ ask.end }} </td>
        <td class="pl-4"> 
          <button 
            class="btn btn-success"
            *ngIf='ask.user.email !== user.email'
            data-toggle="modal"
            [attr.data-target]="'#' + i"
            data-whatever="@mdo"
            > 
            <i class="fas fa-handshake" title="Proposer un accord"></i>
          </button>
          <button
            class="btn btn-info ml-1"
            (click)="onViewAsk(i)"> 
            <i class="fas fa-search"></i>
          </button>
        </td>
      </tr>
      <div class="modal fade" id="{{i}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Je propose mon service</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form [formGroup]="offerForm">
                <div class="form-group">
                  <label for="recipient-name" class="col-form-label">Recipient:</label>
                  <input
                    type="text"
                    class="form-control"
                    id="recipient-name"
                    formControlName="recipient">
                </div>
                <div class="form-group">
                  <label for="message-text" class="col-form-label">{{ask.user.name}}</label>
                  <input 
                    class="form-control"
                    id="message-text"
                    formControlName="text">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Send message</button>
            </div>
          </div>
        </div>
      </div>
    <script src='assets/modal.js'></script>
    </tbody>
  </table>
</div>